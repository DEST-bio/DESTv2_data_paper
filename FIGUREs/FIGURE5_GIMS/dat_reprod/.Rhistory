bx[2] + (bx[2] - bx[1]) / 1000 + (bx[2] - bx[1]) / 50
)
box.cy <- c(bx[3], bx[3])
box.sy <- (bx[4] - bx[3]) / n
xx <- rep(box.cx, each = 2)
par(xpd = TRUE)
for (i in 1:n) {
yy <- c(
box.cy[1] + (box.sy * (i - 1)),
box.cy[1] + (box.sy * (i)),
box.cy[1] + (box.sy * (i)),
box.cy[1] + (box.sy * (i - 1))
)
polygon(xx, yy, col = col[i], border = col[i])
}
par(new = TRUE)
plot(0, 0,
type = "n",
ylim = c(min(lev), max(lev)),
yaxt = "n", ylab = "",
xaxt = "n", xlab = "",
frame.plot = FALSE
)
map.axes(side = 4, las = 2, tick = FALSE, line = .25)
par <- opar
}
dataset <- read.table("/Users/jcnunez/Library/CloudStorage/OneDrive-UniversityofVermont/Documents/GitHub/DESTv2_data_paper/FIGUREs/FIGURE2_Invs/FullInvDestv2.txt", header = T, na.string = "NA")
dataset
library(tidyverse)
library(magrittr)
library(reshape2)
library(vroom)
library(ggExtra)
library(foreach)
library(data.table)
library(factoextra)
library(cowplot)
library(pheatmap)
#load geoanalysis packages
library(rnaturalearth)
library(rnaturalearthdata)
dataset <- na.omit(dataset)
attach(dataset)
dataset
world <- map_data("world")
ggplot() +
geom_map(
data = world, map = world,
aes(long, lat, map_id = region),
color = "white", fill = "lightgray", linewidth = 0.1
) + theme_classic() -> base_world
dataset
dataset %>% melt(id = c("Latitude",   "Longitude", "DEST") )
dataset %>% melt(id = c("Latitude",   "Longitude", "DEST") ) -> dataset.m
dataset.m %>% head
base_world +
geom_point(
data = dataset.m,
aes(x=Longitude,
y=Latitude,
fill = value,
shape= DEST
),
size = 2.3
) + facet_grid(~variable)
base_world +
geom_point(
data = dataset.m,
aes(x=Longitude,
y=Latitude,
fill = value,
shape= as.factor(DEST)
),
size = 2.3
) + facet_grid(~variable)
base_world +
geom_point(
data = dataset.m,
aes(x=Longitude,
y=Latitude,
fill = value,
shape= as.factor(DEST)
),
size = 2.3
) + scale_shape_manual(values = 21:22) +
+ facet_wrap(~variable, ncol = 2)
base_world +
geom_point(
data = dataset.m,
aes(x=Longitude,
y=Latitude,
fill = value,
shape= as.factor(DEST)
),
size = 2.3
) + scale_shape_manual(values = 21:22) +
facet_wrap(~variable, ncol = 2)
base_world +
geom_point(
data = dataset.m,
aes(x=Longitude,
y=Latitude,
fill = value,
shape= as.factor(DEST)
),
size = 2.3
) + scale_shape_manual(values = 21:22) +
scale_fill_gradient2(midpoint = 0.5) +
facet_wrap(~variable, ncol = 2)
base_world +
geom_point(
data = dataset.m,
aes(x=Longitude,
y=Latitude,
fill = value,
shape= as.factor(DEST)
),
size = 2.3
) + scale_shape_manual(values = 21:22) +
scale_fill_gradient2(midpoint = 0.5, low = "yellow", mid = "red", high - "blue") +
facet_wrap(~variable, ncol = 2)
base_world +
geom_point(
data = dataset.m,
aes(x=Longitude,
y=Latitude,
fill = value,
shape= as.factor(DEST)
),
size = 2.3
) + scale_shape_manual(values = 21:22) +
scale_fill_gradient2(midpoint = 0.5, low = "yellow", mid = "red", high = "blue") +
facet_wrap(~variable, ncol = 2)
base_world +
geom_point(
data = dataset.m,
aes(x=Longitude,
y=Latitude,
fill = value,
shape= as.factor(DEST)
),
size = 2.3
) + scale_shape_manual(values = 21:22) +
scale_fill_gradient2(midpoint = 0.3, low = "yellow", mid = "red", high = "blue") +
facet_wrap(~variable, ncol = 2)
base_world +
geom_point(
data = dataset.m,
aes(x=Longitude,
y=Latitude,
fill = value,
shape= as.factor(DEST)
),
size = 2.3
) + scale_shape_manual(values = 21:22) +
scale_fill_gradient2(midpoint = 0.4, low = "yellow", mid = "red", high = "blue") +
facet_wrap(~variable, ncol = 2)
base_world +
geom_point(
data = dataset.m,
aes(x=Longitude,
y=Latitude,
fill = value,
shape= as.factor(DEST)
),
size = 2.3
) + scale_shape_manual(values = 21:22) +
scale_fill_gradientn(
name = "Inversion Frequency",
colours = c("white", "yellow", "red", "purple", "blue")) +
facet_wrap(~variable, ncol = 2)
base_world +
coord_sf(xlim =  c(-12, 41.00), ylim = c(32.00, 63.00), expand = FALSE) +
geom_sf(fill= "lightgray") +
geom_point(
data = dataset.m,
aes(x=Longitude,
y=Latitude,
fill = value,
shape= as.factor(DEST)
),
size = 2.3
) + scale_shape_manual(values = 21:22) +
scale_fill_gradientn(
name = "Inversion Frequency",
colours = c("white", "yellow", "red", "purple", "blue")) +
facet_wrap(~variable, ncol = 2)
base_world +
coord_sf(xlim =  c(-12, 41.00), ylim = c(32.00, 63.00), expand = FALSE) +
geom_point(
data = dataset.m,
aes(x=Longitude,
y=Latitude,
fill = value,
shape= as.factor(DEST)
),
size = 2.3
) + scale_shape_manual(values = 21:22) +
scale_fill_gradientn(
name = "Inversion Frequency",
colours = c("white", "yellow", "red", "purple", "blue")) +
facet_wrap(~variable, ncol = 2)
base_world +
coord_sf(xlim =  c(-125.15, -55), ylim = c(-10, 50.00), expand = FALSE) +
geom_point(
data = dataset.m,
aes(x=Longitude,
y=Latitude,
fill = value,
shape= as.factor(DEST)
),
size = 2.3
) + scale_shape_manual(values = 21:22) +
scale_fill_gradientn(
name = "Inversion Frequency",
colours = c("white", "yellow", "red", "purple", "blue")) +
facet_wrap(~variable, ncol = 2)
base_world +
coord_sf(xlim =  c(-140, 41.00), ylim = c(20.00, 68.00), expand = FALSE) +
geom_point(
data = dataset.m,
aes(x=Longitude,
y=Latitude,
fill = value,
shape= as.factor(DEST)
),
size = 2.3
) + scale_shape_manual(values = 21:22) +
scale_fill_gradientn(
name = "Inversion Frequency",
colours = c("white", "yellow", "red", "purple", "blue")) +
facet_wrap(~variable, ncol = 2)
base_world +
coord_sf(xlim =  c(-140, 41.00), ylim = c(-60, 68.00), expand = FALSE) +
geom_point(
data = dataset.m,
aes(x=Longitude,
y=Latitude,
fill = value,
shape= as.factor(DEST)
),
size = 2.3
) + scale_shape_manual(values = 21:22) +
scale_fill_gradientn(
name = "Inversion Frequency",
colours = c("white", "yellow", "red", "purple", "blue")) +
facet_wrap(~variable, ncol = 2)
base_world +
coord_sf(xlim =  c(-140, 50.00), ylim = c(-60, 68.00), expand = FALSE) +
geom_point(
data = dataset.m,
aes(x=Longitude,
y=Latitude,
fill = value,
shape= as.factor(DEST)
),
size = 2.3
) + scale_shape_manual(values = 21:22) +
scale_fill_gradientn(
name = "Inversion Frequency",
colours = c("white", "yellow", "red", "purple", "blue")) +
facet_wrap(~variable, ncol = 2)
base_world +
coord_sf(xlim =  c(-140, 50.00), ylim = c(-80, 68.00), expand = FALSE) +
geom_point(
data = dataset.m,
aes(x=Longitude,
y=Latitude,
fill = value,
shape= as.factor(DEST)
),
size = 2.3
) + scale_shape_manual(values = 21:22) +
scale_fill_gradientn(
name = "Inversion Frequency",
colours = c("white", "yellow", "red", "purple", "blue")) +
facet_wrap(~variable, ncol = 2)
### plot
base_world +
coord_sf(xlim =  c(-140, 50.00), ylim = c(-60, 80.00), expand = FALSE) +
geom_point(
data = dataset.m,
aes(x=Longitude,
y=Latitude,
fill = value,
shape= as.factor(DEST)
),
size = 2.3
) + scale_shape_manual(values = 21:22) +
scale_fill_gradientn(
name = "Inversion Frequency",
colours = c("white", "yellow", "red", "purple", "blue")) +
facet_wrap(~variable, ncol = 2)
### plot
base_world +
coord_sf(xlim =  c(-140, 80), ylim = c(-60, 65.00), expand = FALSE) +
geom_point(
data = dataset.m,
aes(x=Longitude,
y=Latitude,
fill = value,
shape= as.factor(DEST)
),
size = 2.3
) + scale_shape_manual(values = 21:22) +
scale_fill_gradientn(
name = "Inversion Frequency",
colours = c("white", "yellow", "red", "purple", "blue")) +
facet_wrap(~variable, ncol = 2)
### plot
base_world +
coord_sf(xlim =  c(-140, 140), ylim = c(-60, 65.00), expand = FALSE) +
geom_point(
data = dataset.m,
aes(x=Longitude,
y=Latitude,
fill = value,
shape= as.factor(DEST)
),
size = 2.3
) + scale_shape_manual(values = 21:22) +
scale_fill_gradientn(
name = "Inversion Frequency",
colours = c("white", "yellow", "red", "purple", "blue")) +
facet_wrap(~variable, ncol = 2)
### plot
base_world +
coord_sf(xlim =  c(-140, 155), ylim = c(-60, 65.00), expand = FALSE) +
geom_point(
data = dataset.m,
aes(x=Longitude,
y=Latitude,
fill = value,
shape= as.factor(DEST)
),
size = 2.3
) + scale_shape_manual(values = 21:22) +
scale_fill_gradientn(
name = "Inversion Frequency",
colours = c("white", "yellow", "red", "purple", "blue")) +
facet_wrap(~variable, ncol = 2)
### plot
base_world +
coord_sf(xlim =  c(-145, 155), ylim = c(-60, 65.00), expand = FALSE) +
geom_point(
data = dataset.m,
aes(x=Longitude,
y=Latitude,
fill = value,
shape= as.factor(DEST)
),
size = 2.3
) + scale_shape_manual(values = 21:22) +
scale_fill_gradientn(
name = "Inversion Frequency",
colours = c("white", "yellow", "red", "purple", "blue")) +
facet_wrap(~variable, ncol = 2)
### plot
base_world +
coord_sf(xlim =  c(-120, 155), ylim = c(-60, 65.00), expand = FALSE) +
geom_point(
data = dataset.m,
aes(x=Longitude,
y=Latitude,
fill = value,
shape= as.factor(DEST)
),
size = 2.3
) + scale_shape_manual(values = 21:22) +
scale_fill_gradientn(
name = "Inversion Frequency",
colours = c("white", "yellow", "red", "purple", "blue")) +
facet_wrap(~variable, ncol = 2)
### plot
base_world +
coord_sf(xlim =  c(-138, 155), ylim = c(-60, 65.00), expand = FALSE) +
geom_point(
data = dataset.m,
aes(x=Longitude,
y=Latitude,
fill = value,
shape= as.factor(DEST)
),
size = 2.3
) + scale_shape_manual(values = 21:22) +
scale_fill_gradientn(
name = "Inversion Frequency",
colours = c("white", "yellow", "red", "purple", "blue")) +
facet_wrap(~variable, ncol = 2)
### plot
base_world +
coord_sf(xlim =  c(-135, 1595), ylim = c(-59, 63.00), expand = FALSE) +
geom_point(
data = dataset.m,
aes(x=Longitude,
y=Latitude,
fill = value,
shape= as.factor(DEST)
),
size = 2.3
) + scale_shape_manual(values = 21:22) +
scale_fill_gradientn(
name = "Inversion Frequency",
colours = c("white", "yellow", "red", "purple", "blue")) +
facet_wrap(~variable, ncol = 2)
### plot
base_world +
coord_sf(xlim =  c(-135, 159), ylim = c(-59, 63.00), expand = FALSE) +
geom_point(
data = dataset.m,
aes(x=Longitude,
y=Latitude,
fill = value,
shape= as.factor(DEST)
),
size = 2.3
) + scale_shape_manual(values = 21:22) +
scale_fill_gradientn(
name = "Inversion Frequency",
colours = c("white", "yellow", "red", "purple", "blue")) +
facet_wrap(~variable, ncol = 2)
### plot
base_world +
coord_sf(xlim =  c(-135, 160), ylim = c(-62, 61.00), expand = FALSE) +
geom_point(
data = dataset.m,
aes(x=Longitude,
y=Latitude,
fill = value,
shape= as.factor(DEST)
),
size = 2.3
) + scale_shape_manual(values = 21:22) +
scale_fill_gradientn(
name = "Inversion Frequency",
colours = c("white", "yellow", "red", "purple", "blue")) +
facet_wrap(~variable, ncol = 2)
### plot
base_world +
coord_sf(xlim =  c(-135, 160), ylim = c(-62, 63.00), expand = FALSE) +
geom_point(
data = dataset.m,
aes(x=Longitude,
y=Latitude,
fill = value,
shape= as.factor(DEST)
),
size = 2.3
) + scale_shape_manual(values = 21:22) +
scale_fill_gradientn(
name = "Inversion Frequency",
colours = c("white", "yellow", "red", "purple", "blue")) +
facet_wrap(~variable, ncol = 2)
### plot
base_world +
coord_sf(xlim =  c(-135, 160), ylim = c(-62, 64.00), expand = FALSE) +
geom_point(
data = dataset.m,
aes(x=Longitude,
y=Latitude,
fill = value,
shape= as.factor(DEST)
),
size = 2.3
) + scale_shape_manual(values = 21:22) +
scale_fill_gradientn(
name = "Inversion Frequency",
colours = c("white", "yellow", "red", "purple", "blue")) +
facet_wrap(~variable, ncol = 2)
### plot
base_world +
coord_sf(xlim =  c(-135, 160), ylim = c(-62, 68.00), expand = FALSE) +
geom_point(
data = dataset.m,
aes(x=Longitude,
y=Latitude,
fill = value,
shape= as.factor(DEST)
),
size = 2.3
) + scale_shape_manual(values = 21:22) +
scale_fill_gradientn(
name = "Inversion Frequency",
colours = c("white", "yellow", "red", "purple", "blue")) +
facet_wrap(~variable, ncol = 2)
ggsave("/Users/jcnunez/Library/CloudStorage/OneDrive-UniversityofVermont/Documents/GitHub/DESTv2_data_paper/FIGUREs/FIGURE2_Invs/Fig2.new.pdf",
world_plot,
width = 12,
height = 6
)
### plot
base_world +
coord_sf(xlim =  c(-135, 160), ylim = c(-62, 68.00), expand = FALSE) +
geom_point(
data = dataset.m,
aes(x=Longitude,
y=Latitude,
fill = value,
shape= as.factor(DEST)
),
size = 2.3
) + scale_shape_manual(values = 21:22) +
scale_fill_gradientn(
name = "Inversion Frequency",
colours = c("white", "yellow", "red", "purple", "blue")) +
facet_wrap(~variable, ncol = 2) -> world_plot
ggsave("/Users/jcnunez/Library/CloudStorage/OneDrive-UniversityofVermont/Documents/GitHub/DESTv2_data_paper/FIGUREs/FIGURE2_Invs/Fig2.new.pdf",
world_plot,
width = 12,
height = 6
)
?write.table
